---
layout: single
title: "[병렬및분산시스템] 3장 CUDA 프로그래밍 연습"
excerpt: "3장 CUDA 프로그래밍 연습"
date: 2021-11-06T00:00:00+09:00
toc: true
toc_sticky: true
use_math: true
categories:
  - 전공
  - 병렬및분산시스템
tags:
  - 전공
  - 병렬및분산시스템
---

## Heterogeneous Programming Model

#### Host

- GPU를 제외환 나머지를 가리킴(CPU, 메인메모리 중심)
- 일반적으로 serial code(직렬코드, host code)를 실행
    - kernel function 호출하는 작업
- load가 작은 parallel code 실행
    - ex) 행렬을 구성하는 원소에 대한 총합을 구하는 것

#### Device

- GPU를 가리킴
- parallel code(device code)를 실행

![Untitled 0](https://user-images.githubusercontent.com/60471550/235725568-a34635b4-dcb1-4225-8c9a-2a385f31238f.png)

![Untitled 1](https://user-images.githubusercontent.com/60471550/235725574-4caf51a1-b2ed-430f-a999-6753924d1ddd.png)

## nvcc 컴파일러

- NVIDIA에서 제공하는 컴파일러
- CUDA 라이브러리가 포함된 .cu 파일을 컴파일 및 실행 파일 생성

![Untitled 2](https://user-images.githubusercontent.com/60471550/235725581-c7281a91-5659-431b-8efd-e0bd21ecbb7c.png)

![Untitled 3](https://user-images.githubusercontent.com/60471550/235725582-36e01e1d-43af-4a91-b088-e625895d4b66.png)

![Untitled 4](https://user-images.githubusercontent.com/60471550/235725585-72fbd98e-0205-4b3b-b541-655a32470601.png)

![Untitled 5](https://user-images.githubusercontent.com/60471550/235725592-417ad57b-3c44-4ef0-b1d2-d21d0336f121.png)

![Untitled 6](https://user-images.githubusercontent.com/60471550/235725595-e95751ed-bf4e-43b2-9875-519a81a629b3.png)

![Untitled 7](https://user-images.githubusercontent.com/60471550/235725598-73d7b5a0-bee9-4001-9a5a-7ea59ffbac66.png)

## 디바이스 메모리 할당

![Untitled 8](https://user-images.githubusercontent.com/60471550/235725606-a01affe5-899a-4c27-a794-d56483eee797.png)

- malloc() : host메모리를 할당하는 함수
- cudaMalloc() : 디바이스 메모리를 할당하는 함수
- cudaMemcpy() : 디바이스 메모리에서 호스트 메모리로 또는 반대로 복사하는 함수

## 디바이스 정보 질의하기

#### cudaGetDeviceCount(&count)

- 설치된  CUDA 디바이스 개수 조사

#### cudaDeviceProp 구조체

- 디바이스와 관련된 정보 질의
- CUDA compute capability 버전에 따라 내용이 다소 상이함
![Untitled 9](https://user-images.githubusercontent.com/60471550/235725608-a48cc38d-518d-453d-a5d3-63b5984b4658.png)
![Untitled 10](https://user-images.githubusercontent.com/60471550/235725615-0504ca3f-2c3a-4bf6-a015-56b510b4b306.png)
![Untitled 11](https://user-images.githubusercontent.com/60471550/235725619-e8dc34b6-7109-465d-8cbd-1e8e4ae8054f.png)
![Untitled 12](https://user-images.githubusercontent.com/60471550/235725623-e47a7a02-4354-4333-90ab-178c95ef5ce9.png)